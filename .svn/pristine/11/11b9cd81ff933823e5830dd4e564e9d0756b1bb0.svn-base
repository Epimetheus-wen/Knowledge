(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/preview/preview"],{"09a0":function(o,t,e){"use strict";var n=e("3cc5"),i=e.n(n);i.a},"3c9e":function(o,t,e){"use strict";e.r(t);var n=e("7184"),i=e("c444");for(var s in i)"default"!==s&&function(o){e.d(t,o,(function(){return i[o]}))}(s);e("09a0");var c,a=e("f0c5"),r=Object(a["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],c);t["default"]=r.exports},"3cc5":function(o,t,e){},"612a":function(o,t,e){"use strict";(function(o){e("6cdc"),e("921b");n(e("66fd"));var t=n(e("3c9e"));function n(o){return o&&o.__esModule?o:{default:o}}o(t.default)}).call(this,e("543d")["createPage"])},7184:function(o,t,e){"use strict";var n;e.d(t,"b",(function(){return i})),e.d(t,"c",(function(){return s})),e.d(t,"a",(function(){return n}));var i=function(){var o=this,t=o.$createElement;o._self._c},s=[]},c444:function(o,t,e){"use strict";e.r(t);var n=e("cfef"),i=e.n(n);for(var s in n)"default"!==s&&function(o){e.d(t,o,(function(){return n[o]}))}(s);t["default"]=i.a},cfef:function(o,t,e){"use strict";(function(o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(e("c1df"));function n(o){return o&&o.__esModule?o:{default:o}}var i=function(){e.e("components/headertop").then(function(){return resolve(e("69cd"))}.bind(null,e)).catch(e.oe)},s={data:function(){return{titleTop:"文件预览",staHeight:"",againShow:!0,againTxt:"点击再次阅览文件",platform:"",haibaoUrl:"",imgIcon:"",imgCode:"",nickName:"",loginType:!1,filePath:{},rpx:1,zipShow:!1,obj:{id:""},information:!1}},components:{Headertop:i},onLoad:function(o){this.obj=JSON.parse(decodeURIComponent(o.str)),console.log(o),console.log(this.obj)},onShow:function(){this.information=!1,console.log("状态栏高度");var o=this;wx.getSystemInfo({success:function(t){console.log("状态栏高度",t.statusBarHeight),o.staHeight=t.statusBarHeight,o.rpx=t.windowWidth/375}}),"docx"!=this.obj.accessory_type&&"doc"!=this.obj.accessory_type||(this.imgIcon="../../static/home/word.png"),"ppt"!=this.obj.accessory_type&&"pptx"!=this.obj.accessory_type||(this.imgIcon="../../static/home/ppt.png"),"xls"!=this.obj.accessory_type&&"xlsx"!=this.obj.accessory_type||(this.imgIcon="../../static/home/excel.png"),"pdf"==this.obj.accessory_type&&(this.imgIcon="../../static/home/pdf.png"),"zip"!=this.obj.accessory_type&&"rar"!=this.obj.accessory_type||(this.imgIcon="../../static/home/zip.png"),"jpg"!=this.obj.accessory_type&&"png"!=this.obj.accessory_type||(this.imgIcon="../../static/home/img.png"),"txt"==this.obj.accessory_type&&(this.imgIcon="../../static/home/txt.png"),this.getUserInfo1()},onHide:function(){},onShareAppMessage:function(o){if(2==this.obj.scope)return{title:"易通商务助手",path:"/pages/index/index",imageUrl:this.haibaoUrl,success:function(o){console.log(o)}};console.log("转发",this.haibaoUrl);var t=this.obj;t.filePath=this.filePath;var e=JSON.stringify(t);return{title:this.obj.accessory_name,path:"/pages/outside/share?str="+encodeURIComponent(e),imageUrl:this.haibaoUrl,success:function(o){console.log(o)}}},onReady:function(){var o=this;setTimeout((function(){o.getFilePath()}),1200);var t=this;wx.getSystemInfo({success:function(o){console.log("设备",o),t.platform=o.platform}})},methods:{shareNo:function(){o.showToast({title:"该文档无法分享",icon:"none",duration:2e3})},upImgIcon:function(){console.log("绘图"),this.getUserInfo1()},getUserInfo1:function(){var o=this;wx.getUserInfo({success:function(t){var e=t.userInfo;o.nickName=e.nickName,console.log(e),wx.downloadFile({url:e.avatarUrl,success:function(t){200===t.statusCode&&(console.log(t),o.imgCode=t.tempFilePath,o.share())}})},fail:function(o){console.log(o)}})},share:function(){console.log("share");var o=this,t=wx.createCanvasContext("codecanvas",this);if(t.drawImage("../../static/user/fx_bg.png",0,0,218*o.rpx,175*o.rpx),"../../static/home/img.png"==this.imgIcon||"../../static/home/zip.png"==this.imgIcon?t.drawImage(o.imgIcon,93*o.rpx,30*o.rpx,40*o.rpx,40*o.rpx):t.drawImage(o.imgIcon,93*o.rpx,30*o.rpx,40*o.rpx,48*o.rpx),t.drawImage(o.imgCode,20*o.rpx,132*o.rpx,30*o.rpx,30*o.rpx),t.fillStyle="#242424",o.rpx<=1){console.log(10*o.rpx);var e=Math.round(10*o.rpx);t.font=e+"px SimHei"}else{console.log(10*o.rpx);var n=Math.round(10*o.rpx);t.font=n+"px SimHei"}t.fillStyle="#fff",console.log(o.rpx),t.fillText("来自"+o.nickName+"的分享",60*o.rpx,150*o.rpx),t.draw(!1,setTimeout((function(){wx.canvasToTempFilePath({canvasId:"codecanvas",success:function(t){console.log(t),o.haibaoUrl=t.tempFilePath},fail:function(o){console.log("AAAA",o)}},o)}),1e3))},getFilePath:function(){var o=this;this.$post("/apiIndex.html?f=getFilePath",{id:this.obj.id}).then((function(t){console.log("getFilePath",t),o.downloadFile(t.data),o.filePath=t.data}))},collect:function(o){console.log(o),0==this.obj.fav?this.obj.fav=1:this.obj.fav=0,this.$post("/apiIndex.html?f=collect",{id:o}).then((function(o){console.log("collect",o)}))},showInfo:function(){0==this.information?this.information=!0:this.information=!1,console.log(this.information)},dowInfo:function(){this.information=!1,console.log(this.information)},downloadFile:function(t){var e=this;"ios"==this.platform?wx.downloadFile({url:t.file,success:function(n){console.log(n);var i=wx.getFileSystemManager(),s=n.tempFilePath;if(console.log(i),"jpg"==e.obj.accessory_type||"png"==e.obj.accessory_type)wx.previewImage({current:s,urls:[s],success:function(o){console.log(o),setTimeout((function(){e.againShow=!1}),300)},fail:function(){}});else if("rar"==e.obj.accessory_type||"zip"==e.obj.accessory_type)e.againShow=!1,e.zipShow=!0;else if("txt"==e.obj.accessory_type){wx.getFileSystemManager().readFile({filePath:s,encoding:"utf-8",success:function(o){console.log("txt",o.data)},fail:console.error});var c={url:t.file,name:t.fileName};setTimeout((function(){e.againShow=!1}),300),c=JSON.stringify(c),o.navigateTo({url:"/pages/outside/outside?txtObj="+c})}else wx.openDocument({filePath:s,success:function(o){console.log("打开文件",o),setTimeout((function(){e.againShow=!1}),300)}})}}):wx.downloadFile({url:t.file,success:function(n){console.log(n);var i=wx.getFileSystemManager(),s=n.tempFilePath,c=wx.env.USER_DATA_PATH+"/"+t.fileName;wx.getFileSystemManager().renameSync(s,c),console.log(i),"rar"==e.obj.accessory_type||"zip"==e.obj.accessory_type?(o.showToast({title:"内部存储/tencent/MicroMsg/wxanewfiles/.../"+t.fileName,icon:"none",duration:5e3}),setTimeout((function(){e.againTxt="点击再次下载文件",e.againShow=!1}),300)):wx.openDocument({filePath:c,success:function(o){console.log("打开文档成功"),setTimeout((function(){e.againShow=!1}),300)}})}})}}};t.default=s}).call(this,e("543d")["default"])}},[["612a","common/runtime","common/vendor"]]]);